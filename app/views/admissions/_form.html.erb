<%= form_with(model: admission, local: true) do |form| %>
  <% if admission.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(admission.errors.count, "error") %> prohibited this admission from being saved:</h2>

      <ul>
      <% admission.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <fieldset class="petitioner form__fieldset">
    <legend class="form__fieldset-label"><%= t(:petitioner, scope: [:activerecord, :attributes, :admission]) %></legend>
    <div class="field">
      <%= form.label :veterinarian %>
      <%= form.collection_select :veterinarian_id, Veterinarian.all, :id, :full_name, { include_blank: true} , { id: :admission_veterinarian } %>
    </div>

    <div class="field">
      <%= form.label :veterinary %>
      <%= form.collection_select :veterinary_id, Veterinary.all, :id, :name, { include_blank: true} , { id: :admission_veterinary } %>
    </div>

    <div class="field">
      <%= form.label :petitioner_name %>
      <%= form.text_field :petitioner_name, id: :admission_petitioner_name %>
    </div>

    <div class="field">
      <%= form.label :petitioner_phone %>
      <%= form.text_field :petitioner_phone, id: :admission_petitioner_phone %>
    </div>

    <div class="field">
      <%= form.label :petitioner_email %>
      <%= form.text_field :petitioner_email, id: :admission_petitioner_email %>
    </div>
  </fieldset>

  <fieldset class="patient form__fieldset">
    <legend class="form__fieldset-label"><%= t(:patient, scope: [:activerecord, :attributes, :admission]) %></legend>

    <div class="field">
      <%= form.label :patient_name %>
      <%= form.text_field :patient_name, id: :admission_patient_name %>
    </div>

    <div class="field">
      <%= form.label :species %>
      <%= form.collection_radio_buttons :species, Admission.species, :first, :first do |b| %>
        <%= b.label(class: "radio_button") do %>
          <%= b.radio_button(class: "radio_button") %>
          <%= t(b.text, scope: [:activerecord, :attributes, :admission, :species]) %>
        <% end %>
      <% end %>
    </div>

    <div class="field">
      <%= form.label :sex %>
      <%= form.collection_radio_buttons :sex, Admission.sexes, :first, :first do |b| %>
        <%= b.label(class: "radio_button") do %>
          <%= b.radio_button(class: "radio_button") %>
          <%= t(b.text, scope: [:activerecord, :attributes, :admission, :sex]) %>
        <% end %>
      <% end %>
    </div>

    <div class="field">
      <%= form.label :breed %>
      <%= form.text_field :breed, id: :admission_breed %>
    </div>

    <div class="field">
      <%= form.label :age %>
      <%= form.text_field :age, id: :admission_age %>
    </div>

    <div class="field">
      <%= form.label :owner_name %>
      <%= form.text_field :owner_name, id: :admission_owner_name %>
    </div>
  </fieldset>

  <fieldset class="others form__fieldset">
    <legend class="form__fieldset-label"><%= t(:other, scope: [:common], count: 2) %></legend>
    <div class="field">
      <%= form.label :comments %>
      <%= form.text_area :comments, id: :admission_comments, rows: 5 %>
    </div>
  </fieldset>

  <fieldset class="exams form__fieldset">
    <legend class="form__fieldset-label"><%= t(:exam, scope: [:common], count: 2) %></legend>
    <div class="field">
      <% Exam.category_names.each do |category_name| %>
        <div class="category">
          <h3>
            <%= label_tag nil, class: 'category-list-item' do %>
              <%= check_box_tag(nil, category_name, Exam.for_category_name(category_name).all? { |exam| @admission.exams&.include?(exam) }) %>
              <%= category_name %>
            <% end %>
          </h3>
          <% Exam.for_category_name(category_name).each do |exam| %>
            <%= label_tag nil, class: 'exams-list-item' do %>
              <%= check_box_tag('admission[exams][]', exam, @admission.exams&.include?(exam)) %>
              <%= exam %>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>
  </fieldset>

  <div class="actions">
    <%= form.button class: 'btn btn-primary' %>
  </div>
<% end %>
